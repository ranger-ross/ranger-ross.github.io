<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="default-src 'self';font-src 'self' data:;img-src 'self' https://* data:;media-src 'self';style-src 'self';frame-src player.vimeo.com https://www.youtube-nocookie.com;connect-src 'self';script-src 'self' 'self'" http-equiv=Content-Security-Policy><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://ranger-ross.github.io name=base><title>
ranger-ross • YakMan</title><link title="ranger-ross - Atom Feed" href=https://ranger-ross.github.io/atom.xml rel=alternate type=application/atom+xml><link href="https://ranger-ross.github.io/custom_subset.css?h=0b9535a28bc3d5bf2321" rel=stylesheet><link href="https://ranger-ross.github.io/main.css?h=295fef347cdd0e4ad21f" rel=stylesheet><link href="https://ranger-ross.github.io/skins/blue.css?h=a4dc1e94d3f5759784d2" rel=stylesheet><meta content="light dark" name=color-scheme><meta content="Basic, storage agnostic config manager" name=description><meta content="Basic, storage agnostic config manager" property=og:description><meta content=YakMan property=og:title><meta content=article property=og:type><meta content=en_GB property=og:locale><meta content=https://ranger-ross.github.io/projects/yakman/ property=og:url><meta content=ranger-ross property=og:site_name><noscript><link href=https://ranger-ross.github.io/no_js.css rel=stylesheet></noscript><script src=https://ranger-ross.github.io/js/initializeTheme.min.js></script><script defer src=https://ranger-ross.github.io/js/themeSwitcher.min.js></script><script src="https://ranger-ross.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><header><nav class=navbar><div class=nav-title><a class=home-title href=https://ranger-ross.github.io>ranger-ross</a></div><div class=nav-navs><ul><li><a class="nav-links no-hover-padding" href=https://ranger-ross.github.io/blog/>blog </a><li><a class="nav-links no-hover-padding" href=https://ranger-ross.github.io/projects/>projects </a><li class=menu-icons-container><ul class=menu-icons-group><li class="js menu-icon"><div aria-label="Click or press $SHORTCUT to open search" class="search-icon interactive-icon" title="Click or press $SHORTCUT to open search" id=search-button role=button tabindex=0><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"/></svg></div><li class="theme-switcher-wrapper js"><div aria-label="Toggle dark mode" title="Toggle dark/light mode" aria-pressed=false class=theme-switcher role=button tabindex=0></div><div aria-label="Reset mode to default" class="theme-resetter arrow" title="Reset mode to default" aria-hidden=true role=button tabindex=0></div></ul></ul></div></nav></header><div class=content><main><article><h1 class=article-title>YakMan</h1><ul class=meta><li>30th Nov 2023</ul><section class=body><h1 id=what-and-why><a aria-label="Anchor link for: what-and-why" class="header-anchor no-hover-padding" href=#what-and-why><span aria-hidden=true class=link-icon></span></a> What and why</h1><p><a href=https://github.com/ranger-ross/nihongo-stats>YakMan</a> is a config manager for applications. In modern software development its very common to need to abstract some configuration out of applications so that it can be quickly changed without rebuilding/deploying.<p>There are already many solutions out there for managing config so why bother creating yet another?<p>Let me answer this with a short story…<h3 id=why><a aria-label="Anchor link for: why" class="header-anchor no-hover-padding" href=#why><span aria-hidden=true class=link-icon></span></a> Why</h3><p>I recently joined a new project and most of our configurations were either:<ol><li>Hardcoded in the app<li>Stored in Kubernetes manifest files</ol><p>Both of these required an application restart which at the time was slow and required a lot of red tape cutting to do.<p>I thought surely there was some open source solution that would make this easy. But after researching for a few days, I felt that there was not a solution that I really loved.<p>This lead me to create YakMan.<h3 id=goals><a aria-label="Anchor link for: goals" class="header-anchor no-hover-padding" href=#goals><span aria-hidden=true class=link-icon></span></a> Goals</h3><p>What I really wanted was a config manager that is:<ol><li>Language agnostic<li>Support basic organziation/grouping features<li>Bring your own storage. No vendor lock in and does not require a specific cloud<li>Ability to hotswap config with application restarts<li>Modular with the ability to extend if desired<li>Some basic access control<li>Free and open source</ol><h1 id=tech-stack><a aria-label="Anchor link for: tech-stack" class="header-anchor no-hover-padding" href=#tech-stack><span aria-hidden=true class=link-icon></span></a> Tech Stack</h1><ul><li>Rust<li>Actix<li>SvelteKit<li>Tailwind</ul><h3 id=why-this-tech-stack><a aria-label="Anchor link for: why-this-tech-stack" class="header-anchor no-hover-padding" href=#why-this-tech-stack><span aria-hidden=true class=link-icon></span></a> Why this tech stack</h3><p>I started with the “core” config manager API. One of my goals is a modular design and being able to swap the UI for your own custom UI is important to the project. For that reason, I decided to go with Rust+Actix for the backend service to create a REST API. Rust is nice for its amazing DX and great type system.<p>For the UI, I originally tried to use <a href=https://leptos.dev/>Leptos</a> to keep everything in a single language (Rust). However, I ran into some challenges with Leptos:<ol><li>Leptos at the time was very new (like a few month old) and this might it was still very rough around the edges.<li>Lots of lifetime issues and fighting the borrow checker constantly.</ol><p>I think that Leptos has an awesome community and a bright future. The Discord was always very helpful for newcomers and there are a lot of smart people in it. But with being relatively new to Rust and Leptos being so young I had to make the hard decision to move to another frontend framework.<p>I did some researching and considered my options, and finally landed on SvelteKit. I wanted YakMan to feel lightweight and very snappy, so I was hoping to avoid many V-Dom like React and Angular. I landed on Svelte because offers a very nice DX and makes state management very simple.<p>And after a very large PR to replace Leptos with SvelteKit, I was left with the current tech stack for YakMan.<h1 id=lessons-learned><a aria-label="Anchor link for: lessons-learned" class="header-anchor no-hover-padding" href=#lessons-learned><span aria-hidden=true class=link-icon></span></a> Lessons Learned</h1><h3 id=the-adapter-pattern-is-awesome><a aria-label="Anchor link for: the-adapter-pattern-is-awesome" class="header-anchor no-hover-padding" href=#the-adapter-pattern-is-awesome><span aria-hidden=true class=link-icon></span></a> The adapter pattern is awesome</h3><p>One of the goals for this project is to be able to “bring your own storage” meaning if you on AWS you can S3. If you are GCP you can use Cloud Storage. If you already have a MySQL database and want to use that sure. Just want to store the files locally on an EC2 server, I probably wont reccomened it but you can. One of YakMan’s biggest features is being (somewhat) storage agnostic.<p>To implement feature I used the <a href=https://en.wikipedia.org/wiki/Adapter_pattern>adapter pattern</a>. I create a <code>StorageAdapter</code> trait in Rust (similar to an interface in our languages) that provided methods to read/write data to different storage services. This was probably my best decision I made during the early development of this project.<p>To add support for new storage service, I just needed to implement the <code>StorageAdapter</code> trait for that service and it would “just work.” It was honestly amazing to see YakMan run bug free on a completely different database after just 30 minutes of coding to add a new adapter.<h3 id=oauth-and-sso-can-be-tricky><a aria-label="Anchor link for: oauth-and-sso-can-be-tricky" class="header-anchor no-hover-padding" href=#oauth-and-sso-can-be-tricky><span aria-hidden=true class=link-icon></span></a> OAuth and SSO can be tricky</h3><p>OAuth 2 is a very complicated protocol. There are many different “flows” and it a be tricky to work with especially if the OAuth provider does not follow all of standards.<p>When implementing Single Sign On for YakMan, I ran into a handful of issues where OAuth providers just did not implement some part of the OAuth protocol. This was frustrating but taking a step back I can understand why. OAuth has been a constant work in progress for over a decade now. It has been implemented many RFCs and there are many flows that serve different purposes. It is understandable that not all providers support every feature to the latest RFC.<p>This introduced some challenges and now I understand why many SaaS products charge for SSO. Its a lot of effort to maintain and very difficult to support all identity providers.</section></article></main><div id=button-container><div id=toc-floating-container><input class=toggle id=toc-toggle type=checkbox><label class=overlay for=toc-toggle></label><label title="Toggle Table of Contents" class=button for=toc-toggle id=toc-button><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="M414.82-193.094q-18.044 0-30.497-12.32-12.453-12.319-12.453-30.036t12.453-30.086q12.453-12.37 30.497-12.37h392.767q17.237 0 29.927 12.487 12.69 12.486 12.69 30.203 0 17.716-12.69 29.919t-29.927 12.203H414.82Zm0-244.833q-18.044 0-30.497-12.487Q371.87-462.9 371.87-480.45t12.453-29.92q12.453-12.369 30.497-12.369h392.767q17.237 0 29.927 12.511 12.69 12.512 12.69 29.845 0 17.716-12.69 30.086-12.69 12.37-29.927 12.37H414.82Zm0-245.167q-18.044 0-30.497-12.32t-12.453-30.037q0-17.716 12.453-30.086 12.453-12.369 30.497-12.369h392.767q17.237 0 29.927 12.486 12.69 12.487 12.69 30.203 0 17.717-12.69 29.92-12.69 12.203-29.927 12.203H414.82ZM189.379-156.681q-32.652 0-55.878-22.829t-23.226-55.731q0-32.549 23.15-55.647 23.151-23.097 55.95-23.097 32.799 0 55.313 23.484 22.515 23.484 22.515 56.246 0 32.212-22.861 54.893-22.861 22.681-54.963 22.681Zm0-245.167q-32.652 0-55.878-23.134-23.226-23.135-23.226-55.623 0-32.487 23.467-55.517t56.12-23.03q32.102 0 54.721 23.288 22.62 23.288 22.62 55.775 0 32.488-22.861 55.364-22.861 22.877-54.963 22.877Zm-.82-244.833q-32.224 0-55.254-23.288-23.03-23.289-23.03-55.623 0-32.333 23.271-55.364 23.272-23.03 55.495-23.03 32.224 0 55.193 23.288 22.969 23.289 22.969 55.622 0 32.334-23.21 55.364-23.21 23.031-55.434 23.031Z"/></svg></label><div class=toc-content><div class=toc-container><ul><li><a href=https://ranger-ross.github.io/projects/yakman/#what-and-why>What and why</a> <ul><li><a href=https://ranger-ross.github.io/projects/yakman/#why>Why</a><li><a href=https://ranger-ross.github.io/projects/yakman/#goals>Goals</a></ul><li><a href=https://ranger-ross.github.io/projects/yakman/#tech-stack>Tech Stack</a> <ul><li><a href=https://ranger-ross.github.io/projects/yakman/#why-this-tech-stack>Why this tech stack</a></ul><li><a href=https://ranger-ross.github.io/projects/yakman/#lessons-learned>Lessons Learned</a> <ul><li><a href=https://ranger-ross.github.io/projects/yakman/#the-adapter-pattern-is-awesome>The adapter pattern is awesome</a><li><a href=https://ranger-ross.github.io/projects/yakman/#oauth-and-sso-can-be-tricky>OAuth and SSO can be tricky</a></ul></ul></div></div></div><a title="Go to the top of the page" class=no-hover-padding href=# id=top-button> <svg viewbox="0 0 20 20" fill=currentColor><path d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z"/></svg> </a></div><span class=hidden id=copy-success> Copied! </span><span class=hidden id=copy-init> Copy code to clipboard </span><script defer src=https://ranger-ross.github.io/js/copyCodeToClipboard.min.js></script></div><footer><section><nav class="socials nav-navs"><ul><li><a class="nav-links no-hover-padding social" href=https://ranger-ross.github.io/atom.xml> <img alt=feed loading=lazy src=https://ranger-ross.github.io/social_icons/rss.svg title=feed> </a><li><a class="nav-links no-hover-padding social" rel=" me" href=https://github.com/ranger-ross/> <img alt=github loading=lazy src=https://ranger-ross.github.io/social_icons/github.svg title=github> </a><li><a class="nav-links no-hover-padding social" rel=" me" href=https://www.linkedin.com/in/ross-sullivan-a17568135/> <img alt=linkedin loading=lazy src=https://ranger-ross.github.io/social_icons/linkedin.svg title=linkedin> </a></ul></nav><nav class=nav-navs></nav><div class=credits><small> </small></div></section><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><h1 class=visually-hidden id=modalTitle>Search</h1><div id=modal-content><div id=searchBar><div aria-hidden=true class=search-icon><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"/></svg></div><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search… role=combobox spellcheck=false><div class="close-icon interactive-icon" title="Clear search" id=clear-search role=button tabindex=0><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></div></div><div id=results-container><div id=results-info><span id=zero_results> No results</span><span id=one_results> $NUMBER result</span><span id=many_results> $NUMBER results</span><span id=two_results> $NUMBER results</span><span id=few_results> $NUMBER results</span></div><div id=results role=listbox></div></div></div></div></footer>